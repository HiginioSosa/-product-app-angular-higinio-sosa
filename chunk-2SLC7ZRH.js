import{aa as u,e as n,fa as h,h as o,i as c,j as s,m as l,p,t as a}from"./chunk-JCHXBMBF.js";var g=class i{http=p(h);API_URL="https://fakestoreapi.com";_products=a([]);_loadingState=a("idle");_error=a(null);products=this._products.asReadonly();loadingState=this._loadingState.asReadonly();error=this._error.asReadonly();isLoading=u(()=>this._loadingState()==="loading");loadProducts(){this._loadingState.set("loading"),this._error.set(null),this.http.get(`${this.API_URL}/products`).pipe(s(t=>{this._products.set(t),this._loadingState.set("success")}),o(t=>this.handleError(t)),c(()=>{this._loadingState()==="loading"&&this._loadingState.set("error")})).subscribe()}getProduct(t){return this.http.get(`${this.API_URL}/products/${t}`)}createProduct(t){return this._loadingState.set("loading"),this.http.post(`${this.API_URL}/products`,t).pipe(s(r=>{this._products.update(e=>[r,...e]),this._loadingState.set("success")}),o(r=>this.handleError(r)))}updateProduct(t,r){return this._loadingState.set("loading"),this.http.put(`${this.API_URL}/products/${t}`,r).pipe(s(e=>{this._products.update(_=>_.map(d=>d.id===t?e:d)),this._loadingState.set("success")}),o(e=>this.handleError(e)))}deleteProduct(t){return this._loadingState.set("loading"),this.http.delete(`${this.API_URL}/products/${t}`).pipe(s(()=>{this._products.update(r=>r.filter(e=>e.id!==t)),this._loadingState.set("success")}),o(r=>this.handleError(r)))}handleError(t){let r="An error occurred";return t.error instanceof ErrorEvent?r=`Error: ${t.error.message}`:r=`Error Code: ${t.status}
Message: ${t.message}`,this._error.set(r),this._loadingState.set("error"),console.error("ProductService Error:",t),n(()=>r)}static \u0275fac=function(r){return new(r||i)};static \u0275prov=l({token:i,factory:i.\u0275fac,providedIn:"root"})};export{g as a};
